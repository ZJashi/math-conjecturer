

<blackboard>
  <context>
    <definitions>
      <definition id="def:sa_dynamics" title="SA Dynamics">
        <content>\(\dot{x}_i = \proj_{x_i}\left( \frac{\sum_j e^{\beta\langle x_i,x_j\rangle}x_j}{\sum_k e^{\beta\langle x_i,x_k\rangle}} \right)\)</content>
        <impact>Post-normalization dynamics modeling standard attention</impact>
      </definition>
      <definition id="def:usa_dynamics" title="USA Dynamics">
        <content>\(\dot{x}_i = \proj_{x_i}\left( \frac{1}{n}\sum_j e^{\beta\langle x_i,x_j\rangle}x_j \right)\)</content>
        <impact>Unnormalized variant of attention dynamics</impact>
      </definition>
      <definition id="def:energy_functional" title="Energy Functional">
        <content>\(\mathcal{E}_\beta(\mu) = \frac{1}{2\beta} \iint e^{\beta\langle x,y\rangle} d\mu(x)d\mu(y)\)</content>
        <impact>Drives gradient flow structure of USA dynamics</impact>
      </definition>
    </definitions>

    <theorems>
      <theorem id="thm:clustering_finite" title="Clustering for finite particles">
        <content>For \(d \geq 3\), \(\beta \geq 0\), and almost every initial condition on \((\mathbb{S}^{d-1})^n\), both SA and USA dynamics converge to a single cluster: \(\lim_{t\to\infty} \|x_i(t) - x_j(t)\| = 0\) for all \(i,j\).</content>
        <impact>Establishes global collapse under general conditions</impact>
      </theorem>
      <theorem id="thm:exponential_rates" title="Exponential local rates">
        <content>If tokens start in an open hemisphere, \(\|x_i(t) - x^*\| \leq C e^{-\lambda t}\) for SA/USA, with \(\lambda_\text{USA} \sim e^\beta\), \(\lambda_\text{SA} \sim 1\).</content>
        <impact>Quantifies speed difference between normalized/unnormalized dynamics</impact>
      </theorem>
      <theorem id="thm:mean_field_clustering" title="Mean-field clustering">
        <content>For \(\mu_t\) solving the continuity equation with \(|\beta| < \beta_0\) and \(R_0 > 0\), \(W_2(\mu_t, \delta_{x_\infty}) \leq C_0 e^{-t/100}\).</content>
        <impact>Extends clustering to infinite-particle limit</impact>
      </theorem>
      <theorem id="thm:pairwise_merging" title="Pairwise merging at large \(\beta\)">
        <content>For \(\beta \to \infty\) and equiangular initial clusters, the closest pair merges along their geodesic in rescaled time, while others remain stationary.</content>
        <impact>Characterizes sequential merging in low-temperature regime</impact>
      </theorem>
    </theorems>
  </context>

  <motivation>
    <dissatisfactions>
      <dissatisfaction id="dis:d2_limitation" title="Failure in d=2" source_refs="thm:clustering_finite">
        <desired_behavior>Clustering should hold for all dimensions \(d \geq 2\)</desired_behavior>
        <heuristic>Proofs for \(d \geq 3\) fail due to \(\pi_1(\mathbb{S}^1) \neq 0\) topology</heuristic>
      </dissatisfaction>
      <dissatisfaction id="dis:beta_constraint" title="Mean-field \(\beta\) limitation" source_refs="thm:mean_field_clustering">
        <desired_behavior>Convergence should hold for all \(\beta\)</desired_behavior>
        <heuristic>Current proof requires small \(\beta\) (\(|\beta| < \beta_0\))</heuristic>
      </dissatisfaction>
      <dissatisfaction id="dis:linearization_failure" title="Large \(\beta\) complexity" source_refs="thm:pairwise_merging">
        <desired_behavior>Analysis should extend to arbitrary \(\beta\)</desired_behavior>
        <heuristic>Energy landscape becomes non-convex and linearization fails</heuristic>
      </dissatisfaction>
    </dissatisfactions>

    <examples>
      <example id="ex:equiangular_model" title="Equiangular Model">
        <structure>All tokens satisfy \(\langle x_i, x_j\rangle = \rho(t)\) for \(i \neq j\)</structure>
        <actual_behavior>Yields exact rates: \(1 - \rho(t) \sim e^{-2t}\) (SA) vs. \(e^{-2e^\beta t}\) (USA)</actual_behavior>
        <lesson>Demonstrates sharpness of Theorem 2's exponential rates</lesson>
      </example>
      <counterexample id="cnex:multi_cluster" title="Multi-cluster mean-field">
        <structure>Large \(\beta\) regime with specific initial conditions</structure>
        <actual_behavior>Mean-field dynamics converge to multiple clusters</actual_behavior>
        <lesson>Shows Theorem 3's \(\beta\) constraint is necessary</lesson>
      </counterexample>
    </examples>
  </motivation>

  <frontier>
    <raised_conjectures>
      <raised_conjecture id="conj:noisy_transformers" title="Noisy Transformers">
        <content>Characterize stationary measures of \(\partial_t \mu_t + \kappa^{-1}\Delta \mu_t = \nabla \cdot (\mu_t v_t[\mu_t])\) and their bifurcations</content>
        <heuristic>Understanding stochastic attention dynamics</heuristic>
        <impact>Would bridge theory with practical noisy training</impact>
      </raised_conjecture>
      <raised_conjecture id="conj:metastability_lifetimes" title="Sharp Metastability">
        <content>Derive exact lifetimes of \(k\)-cluster states and transition paths</content>
        <heuristic>Metastable states have exponentially long dwell times \(\sim e^{c\beta}\)</heuristic>
        <impact>Quantify attention's memory capacity via cluster persistence</impact>
      </raised_conjecture>
      <raised_conjecture id="conj:d2_extension" title="d=2 Completion">
        <content>Extend clustering to all \(\beta\) in \(d=2\)</content>
        <heuristic>Partial results exist for \(\beta > -0.16\)</heuristic>
        <impact>Would complete dimensional coverage</impact>
      </raised_conjecture>
      <raised_conjecture id="conj:multi_head" title="Multi-Head Dynamics">
        <content>Analyze dynamics with multiple interaction kernels</content>
        <heuristic>Real Transformers use parallel attention heads</heuristic>
        <impact>Theoretical foundation for multi-head architecture</impact>
      </raised_conjecture>
    </raised_conjectures>
  </frontier>
</blackboard>